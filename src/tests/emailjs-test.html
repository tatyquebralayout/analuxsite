<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Teste EmailJS - AmanluxDog</title>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"
    ></script>
    <script type="text/javascript">
      (function () {
        // Inicializa o EmailJS com a chave pública
        emailjs.init('AmgBu5KTBSjqp5HVm');
      })();
    </script>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
      }
      h1 {
        color: #0d47a1;
        border-bottom: 2px solid #1e88e5;
        padding-bottom: 10px;
      }
      form {
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
      }
      label {
        display: block;
        margin: 10px 0 5px;
        font-weight: bold;
      }
      input,
      textarea,
      select {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }
      button {
        background-color: #1e88e5;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
      }
      button:hover {
        background-color: #0d47a1;
      }
      #result {
        margin-top: 20px;
        padding: 15px;
        border-radius: 4px;
      }
      .success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .error {
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .loading {
        display: none;
        text-align: center;
        margin: 20px 0;
      }
      .spinner {
        border: 4px solid rgba(0, 0, 0, 0.1);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border-left: 4px solid #1e88e5;
        animation: spin 1s linear infinite;
        display: inline-block;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      #configDetails {
        background-color: #fff3cd;
        border: 1px solid #ffeeba;
        color: #856404;
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <h1>Teste de Configuração do EmailJS - AmanluxDog</h1>
    <div id="configDetails">
      <h3>Detalhes da Configuração</h3>
      <p><strong>Public Key:</strong> AmgBu5KTBSjqp5HVm</p>
      <p><strong>Service ID:</strong> service_2lih55m</p>
      <p><strong>Template ID:</strong> template_2lih55m</p>
    </div>

    <form id="testForm">
      <h2>Formulário de Teste</h2>
      <label for="name">Nome:</label>
      <input
        type="text"
        id="name"
        name="name"
        placeholder="Seu nome"
        required
        value="Teste Automatizado"
      />

      <label for="email">Email:</label>
      <input
        type="email"
        id="email"
        name="email"
        placeholder="seu@email.com"
        required
        value="teste@example.com"
      />

      <label for="phone">Telefone:</label>
      <input
        type="tel"
        id="phone"
        name="phone"
        placeholder="+XX XXX XXX XXXX"
        required
        value="+5511999999999"
      />

      <label for="message">Mensagem:</label>
      <textarea id="message" name="message" rows="4" placeholder="Sua mensagem" required>
Esta é uma mensagem de teste automatizado para verificar as configurações do EmailJS. Por favor, ignore.</textarea
      >

      <button type="submit" id="submitBtn">Enviar Teste</button>
    </form>

    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>Enviando email de teste...</p>
    </div>

    <div id="result"></div>

    <div id="console">
      <h3>Console de Logs:</h3>
      <pre
        id="logs"
        style="
          background: #f4f4f4;
          padding: 10px;
          border-radius: 4px;
          overflow: auto;
          max-height: 300px;
        "
      ></pre>
    </div>

    <script type="text/javascript">
      document.getElementById('testForm').addEventListener('submit', function (event) {
        event.preventDefault();

        const loading = document.getElementById('loading');
        const result = document.getElementById('result');
        const logs = document.getElementById('logs');

        // Limpar resultados anteriores
        result.className = '';
        result.innerHTML = '';
        logs.innerHTML = '';

        // Mostrar loading
        loading.style.display = 'block';

        // Log
        addLog('Iniciando teste do EmailJS...');
        addLog(`Service ID: service_2lih55m`);
        addLog(`Template ID: template_2lih55m`);

        // Coletar dados do formulário
        const templateParams = {
          from_name: document.getElementById('name').value,
          reply_to: document.getElementById('email').value,
          phone: document.getElementById('phone').value,
          message: document.getElementById('message').value,
          service_requested: 'teste',
          dog_count: '1',
          dog_size: 'small',
          serviceText: 'Teste de Configuração',
          site_name: 'AmanluxDog',
          date: new Date().toLocaleDateString(),
        };

        addLog('Parâmetros do template:');
        addLog(JSON.stringify(templateParams, null, 2));

        // Registrar tempo de início
        const startTime = new Date();
        addLog(`Iniciando envio: ${startTime.toISOString()}`);

        // Enviar email
        emailjs.send('service_2lih55m', 'template_2lih55m', templateParams).then(
          function (response) {
            const endTime = new Date();
            const duration = (endTime - startTime) / 1000;

            loading.style.display = 'none';
            result.className = 'success';
            result.innerHTML = `
                        <h3>✅ Email enviado com sucesso!</h3>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Texto:</strong> ${response.text}</p>
                        <p><strong>Tempo de envio:</strong> ${duration} segundos</p>
                        <p>Verifique sua caixa de entrada para confirmar que o email foi recebido.</p>
                    `;

            addLog(
              `✅ Email enviado com sucesso! Status: ${response.status}, Texto: ${response.text}`
            );
            addLog(`Tempo de envio: ${duration} segundos`);
          },
          function (error) {
            const endTime = new Date();
            const duration = (endTime - startTime) / 1000;

            loading.style.display = 'none';
            result.className = 'error';
            result.innerHTML = `
                        <h3>❌ Erro ao enviar email!</h3>
                        <p><strong>Erro:</strong> ${error.text}</p>
                        <p><strong>Tempo decorrido:</strong> ${duration} segundos</p>
                        <p>Verifique as configurações do EmailJS e tente novamente.</p>
                    `;

            addLog(`❌ Erro ao enviar email: ${error.text}`);
            addLog(`Detalhes do erro: ${JSON.stringify(error, null, 2)}`);
            addLog(`Tempo decorrido: ${duration} segundos`);
          }
        );
      });

      function addLog(message) {
        const logs = document.getElementById('logs');
        const timestamp = new Date().toISOString();
        logs.innerHTML += `[${timestamp}] ${message}\n`;
        logs.scrollTop = logs.scrollHeight;
        console.log(`[${timestamp}] ${message}`);
      }
    </script>
  </body>
</html>
